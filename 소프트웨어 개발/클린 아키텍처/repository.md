> Repository 패턴의 주요 역할은 데이터 접근 논리를 비지니스 논리로부터 분리하고 추상화하는 것이다.
> 
> 클린 아키텍처에서 Repository는 데이터를 저장하고 조회하는 기능 그 자체를 의미하며, 이 기능을 시스템의 핵심 비지니스 로직으로부터 보호하는 방화벽 역할을 수행한다.

Repository 패턴 기반 구조

1. 도메인 계층(Domain Layer): 데이터 모델(Interfaces)과 비지니스 Repository 인터페이스 정의
2. 인프라 계층(Infrastructure Layer): 실제 데이터 접근 구현체(Implementation) 작성 - 실제 API 통신 코드 정의
3. 프레젠테이션 계층(Presentation Layer): 컴포넌트에서 Repository 인터페이스를 사용하여 데이터를 요청.

### 1.도메인 계층과 데이터 계층의 분리

- Repository 인터페이스: Repository의 역할은 도메인 계층에 정의된 인터페이스를 통해 추상화한다.도메인 계층은 어떤 데이터가 필요하다는 것만 알 뿐, 그 데이터를 어떻게(데이터베이스, 외부 API,파일 등) 가져오는지에 대해서는 전혀 알지 못한다.
- Repository 구현체: 실제 데이터 접근 코드는 인프라 계층에 위치한 Repository의 구현체(Implementation) 에서 처리한다. 예를 들어, `UserRepository` 인터페이스는 도메인 계층에 있지만, `SqlUserRepository` 구현체는 인프라 계층에 있다.

### 2.데이터 접근의 추상화

- Repository는 도메인 계층의 요청을 특정 데이터베이스나 외부 API에 종속되지 않은 형태로 추상화한다.
	- 예를 들어, `findUserById(id)` 메서드는 도메인 계층에서 호출되지만, 실제로는 SQL 쿼리, NoSQL 조회, 또는 외부 API 호출 등 다양한 방식으로 구현될 수 있다.
	- 이로 인해 도메인 계층은 데이터 저장소의 종류나 접근 방식에 대해 신경 쓸 필요가 없어진다.
- 의존성 역전 원칙(DIP)을 따른다.
	- 도메인 계층은 Repository 인터페이스에 의존하고, 구체적인 구현체에는 의존하지 않는다. 이를 통해 도메인 계층은 데이터 접근 방식의 변화에 영향을 받지 않게 된다.
	- 고수준 모듈 (도메인 계층): Repository 인터페이스에 의존
	- 저수준 모듈 (인프라 계층): Repository 구현체에 의존

### 3. 데이터 용이성 확보

- Repository를 인터페이스 분리하면, 유즈케이스나 엔티티와 같은 핵심 비지니스 로직을 테스트할때 실제 데이터베이스에 연결할 필요가 없다.
	- 예를 들어, `InMemoryUserRepository` 같은 테스트용 구현체를 만들어서, 실제 데이터베이스 없이도 도메인 로직을 검증할 수 있다.
- 테스트 시 Mock Repository나 Stub을 구현하여 Repository 인테페이스를 대체할 수 있다. 이는 테스트 속도를 높이고 외부 요인에 의존하지 않는 단위 테스트를 가능하게 한다.

### Repository 패턴의 이점

- 교체 용이성: API를 변경해도 인터페이스를 구현하는 새로운 클래스만 작성하면 되므로, 도메인 계층(컴포넌)에는 영향을 미치지 않는다.