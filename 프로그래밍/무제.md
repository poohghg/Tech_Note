### Day 1-2: ê°œë°œ í™˜ê²½ êµ¬ì¶• ë° JSX ì†Œê°œ 

### ğŸ’» ì†”ë£¨ì…˜ ë° í•´ì„¤

**1. Viteì™€ TypeScriptë¡œ í”„ë¡œì íŠ¸ ì´ˆê¸°í™”í•˜ê¸°**

```bash
# Vite í”„ë¡œì íŠ¸ ìƒì„±
npm create vite@latest my-react-clone -- --template vanilla-ts
cd my-react-clone
npm install
```

**2. í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜**

```bash
npm install --save-dev vite-tsconfig-paths
```

**3. Vite ì„¤ì • íŒŒì¼ ì‘ì„± (`vite.config.ts`)**

```tsx
// vite.config.ts
import { defineConfig } from 'vite';
import tsconfigPaths from 'vite-tsconfig-paths';

export default defineConfig({
  plugins: [
    tsconfigPaths(),
  ],
  esbuild: {
    jsx: 'transform',
    jsxDev: false,
    jsxImportSource: '@/libs/jsx',
    jsxInject: `import { createElement } from '@/libs/jsx/jsx-runtime'`,
    jsxFactory: 'createElement',
  },
});
```

- ì„¤ëª…:
  - https://legacy.reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html
  - `esbuild` ì˜µì…˜ì—ì„œ `jsx`ë¥¼ `'transform'`ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ JSXë¥¼ íŠ¸ëœìŠ¤íŒŒì¼ë§í•©ë‹ˆë‹¤.
  - `jsxImportSource`ë¥¼ ì„¤ì •í•˜ì—¬ ì‚¬ìš©ì ì •ì˜ JSX ëŸ°íƒ€ì„ì„ ì§€ì •í•©ë‹ˆë‹¤.
  - `jsxInject`ë¥¼ í†µí•´ ëª¨ë“  JSX íŒŒì¼ì— ìë™ìœ¼ë¡œ `import { jsx } from '@/libs/jsx/jsx-runtime'`ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
  - `jsxFactory`ë¥¼ `'jsx.createElement'`ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ JSXê°€ `jsx.createElement` í•¨ìˆ˜ë¡œ ë³€í™˜ë˜ë„ë¡ í•©ë‹ˆë‹¤.

------

### ğŸ’¡ í•´ì„¤

- **Babel ì„¤ì •ì—ì„œ `runtime: 'automatic'`ê³¼ `importSource`ë¥¼ ì‚¬ìš©í•˜ì—¬**, Babelì´ JSXë¥¼ íŠ¸ëœìŠ¤íŒŒì¼í•  ë•Œ í•„ìš”í•œ í•¨ìˆ˜ë¥¼ ìë™ìœ¼ë¡œ ì„í¬íŠ¸í•˜ë„ë¡ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.
- `createElement` í•¨ìˆ˜ëŠ” `src/createElement.js`ì— êµ¬í˜„í•˜ê³ , `src/jsx-runtime.js`ì—ì„œ ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ `jsx`, `jsxs` í•¨ìˆ˜ë¥¼ ì •ì˜í–ˆìŠµë‹ˆë‹¤.
- ì´ë¡œì¨ ê° JSX íŒŒì¼ì—ì„œ `createElement` í•¨ìˆ˜ë¥¼ ì „ì—­ìœ¼ë¡œ ë“±ë¡í•˜ê±°ë‚˜, ëª…ì‹œì ìœ¼ë¡œ ì„í¬íŠ¸í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤.

------

### Day 3-4: `createElement` í•¨ìˆ˜ êµ¬í˜„ê³¼ Virtual DOM ìƒì„±

### ğŸ’» ì†”ë£¨ì…˜ ë° í•´ì„¤

**1. `createElement` í•¨ìˆ˜ êµ¬í˜„**

```jsx
// src/libs/jsx/jsx-runtime.ts
import { DefaultProps, VirtualDOM, VirtualNode, Component } from '../vtu/types';

export const createElement = (
  component: keyof HTMLElementTagNameMap | Component,
  props: Record<string, unknown> | null,
  ...children: (VirtualDOM | VirtualNode)[]
): JSX.Element => {
  if (typeof component === 'function') {
    return component({ ...props, children })
  }
 
  return {
    node: {
      tag: component,
      props,
      children: children.flat().map((child) => {
        // ì¼ë°˜ì ì¸ í…ìŠ¤íŠ¸ë¼ë©´
        if (!checkIsVirtualNode(child as VirtualDOM | VirtualNode)) {
          return { node: child } as VirtualDOM
        }
        return child
      }) as VirtualDOM[],
    },
  }
}

export const jsx = { createElement }

const checkIsVirtualNode = (
  obj: VirtualDOM | VirtualNode,
): obj is VirtualDOM => {
  if (Array.isArray(obj)) {
    return false
  }
  if (typeof obj === 'object' && obj != null && 'node' in obj) {
    return true
  }

  return false
}
```

- `createElement` í•¨ìˆ˜ëŠ” JSXë¥¼ ìš°ë¦¬ê°€ ì •ì˜í•œ VDOM í˜•íƒœë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
- ì»´í¬ë„ŒíŠ¸ê°€ í•¨ìˆ˜ì¸ ê²½ìš° í•´ë‹¹ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ê²°ê³¼ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
- ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ VDOM ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
- `children`ì€ ì¬ê·€ì ìœ¼ë¡œ í‰íƒ„í™”í•˜ì—¬ VDOM ë°°ì—´ë¡œ ë§Œë“­ë‹ˆë‹¤.




**2. ê°„ë‹¨í•œ JSX ì‘ì„± ë° íŠ¸ëœìŠ¤íŒŒì¼ ê²°ê³¼ í™•ì¸**

```jsx
// src/App.jsx
function App() {
  return (
    <div id="app">
      <h1>Hello, React</h1>
    </div>
  );
}

export default App;
```

**íŠ¸ëœìŠ¤íŒŒì¼ëœ ê²°ê³¼**

```jsx
import { jsx as _jsx } from './jsx-runtime.js';

function App() {
  return _jsx('div', { id: 'app', children: _jsx('h1', { children: 'Hello, React Clone!' }) });
}

export default App;
```

**3. Virtual DOM ê°ì²´ í™•ì¸**

```jsx
// src/main.js
import App from './App.jsx';

const appElement = App();

console.log(JSON.stringify(appElement, null, 2));
```

**ì½˜ì†” ì¶œë ¥ ê²°ê³¼**

```json
{
  "type": "div",
  "props": {
    "id": "app",
    "children": {
      "type": "h1",
      "props": {
        "children": "Hello, React Clone!"
      }
    }
  }
}
```

------

### ğŸ’¡ í•´ì„¤

- `createElement` í•¨ìˆ˜ëŠ” JSXì—ì„œ ë³€í™˜ëœ í•¨ìˆ˜ í˜¸ì¶œì„ í†µí•´ Virtual DOM ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
- ìƒì„±ëœ Virtual DOMì€ ì¬ê·€ì ì¸ ê°ì²´ êµ¬ì¡°ë¡œ, ì‹¤ì œ DOM êµ¬ì¡°ë¥¼ ë°˜ì˜í•©ë‹ˆë‹¤.

------

### Day 5: ê°„ë‹¨í•œ ì»´í¬ë„ŒíŠ¸ ì‘ì„± ë° ì‹¤ìŠµ

### ğŸ’» ì†”ë£¨ì…˜ ë° í•´ì„¤

**1. ìì‹ ì»´í¬ë„ŒíŠ¸ ì‘ì„±**

```jsx
// src/Header.jsx
function Header() {
  return (
    <header>
      <h1>My React Clone</h1>
    </header>
  );
}

export default Header;
// src/Content.jsx
function Content() {
  return (
    <main>
      <p>This is a sample content.</p>
    </main>
  );
}

export default Content;
```

**2. `App` ì»´í¬ë„ŒíŠ¸ì—ì„œ ìì‹ ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©**

```jsx
// src/App.jsx
import Header from './Header.jsx';
import Content from './Content.jsx';

function App() {
  return (
    <div id="app">
      <Header />
      <Content />
    </div>
  );
}

export default App;
```

**3. íŠ¸ëœìŠ¤íŒŒì¼ëœ ê²°ê³¼**

```jsx
import { jsx as _jsx, jsxs as _jsxs } from './jsx-runtime.js';
import Header from './Header.jsx';
import Content from './Content.jsx';

function App() {
  return _jsxs('div', {
    id: 'app',
    children: [_jsx(Header, {}), _jsx(Content, {})],
  });
}

export default App;
```

**4. Virtual DOM ê°ì²´ í™•ì¸**

```jsx
// src/main.js
import App from './App.jsx';

const appElement = App();

console.log(JSON.stringify(appElement, null, 2));
```

**ì½˜ì†” ì¶œë ¥ ê²°ê³¼**

```json
{
  "type": "div",
  "props": {
    "id": "app",
    "children": [
      {
        "type": [Function: Header],
        "props": {}
      },
      {
        "type": [Function: Content],
        "props": {}
      }
    ]
  }
}
```

---

### ğŸ’¡ í•´ì„¤

- ì»´í¬ë„ŒíŠ¸ëŠ” í•¨ìˆ˜ë¡œ ì •ì˜ë˜ë©°, ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- Virtual DOMì—ì„œ `type`ì´ í•¨ìˆ˜ì¸ ê²½ìš°, í•´ë‹¹ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ê·¸ ê²°ê³¼ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
- ì‹¤ì œ ë Œë”ë§ ì‹œì—ëŠ” ì´ëŸ¬í•œ ì¬ê·€ì ì¸ í˜¸ì¶œì„ í†µí•´ ìµœì¢…ì ì¸ DOM êµ¬ì¡°ë¥¼ ë§Œë“­ë‹ˆë‹¤.

## Week1 ë©´ì ‘ì§ˆë¬¸

- Viteì™€ Babelì„ ì‚¬ìš©í•˜ì—¬ ê°œë°œ í™˜ê²½ì„ ì–´ë–»ê²Œ êµ¬ì¶•í•˜ì…¨ë‚˜ìš”?

  - Viteë¥¼ ì„ íƒí•œ ì´ìœ ì™€ ê·¸ ì¥ì ì€ ë¬´ì—‡ì¸ê°€ìš”?

    **Webpack** â†” **Vite**ëŠ” **ë¹ ë¥¸ ê°œë°œ ì„œë²„**ì™€ **íš¨ìœ¨ì ì¸ ë²ˆë“¤ë§**ì„ ì œê³µí•˜ëŠ” ë„êµ¬ë¡œ, íŠ¹íˆ ëª¨ë“ˆ í•« ë¦¬ë¡œë”©(HMR)ì´ ë§¤ìš° ë¹ ë¦…ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì€ ì´ìœ ë¡œ ì„ íƒí–ˆìŠµë‹ˆë‹¤:

    - **ES ëª¨ë“ˆ ê¸°ë°˜ ë¹Œë“œ**: ViteëŠ” ìµœì‹  ë¸Œë¼ìš°ì €ì˜ ES ëª¨ë“ˆ ì§€ì›ì„ í™œìš©í•˜ì—¬ ë¹ ë¥´ê²Œ íŒŒì¼ì„ ì œê³µ.
    - **ë¹ ë¥¸ ìŠ¤íƒ€íŠ¸ì—… ì‹œê°„**: Webpackê³¼ ë¹„êµí•˜ì—¬ ì´ˆê¸° ë²ˆë“¤ë§ ì‹œê°„ì´ í›¨ì”¬ ì§§ìŒ.
    - **í”ŒëŸ¬ê·¸ì¸ ì—ì½”ì‹œìŠ¤í…œ**: Rollup ê¸°ë°˜ìœ¼ë¡œ í™•ì¥ì„±ì´ ë›°ì–´ë‚¨.

- JSXë€ ë¬´ì—‡ì´ë©°, ì™œ Reactì—ì„œ ì‚¬ìš©í•˜ëŠ”ì§€ ì„¤ëª…í•´ ì£¼ì„¸ìš”.

  - ì˜ê²¬

    **JSXë€ ë¬´ì—‡ì¸ê°€ìš”?**

    JSX(JavaScript XML)ëŠ” **JavaScriptì˜ í™•ì¥ ë¬¸ë²•**ìœ¼ë¡œ, UIë¥¼ ì„ ì–¸ì ìœ¼ë¡œ ì‘ì„±í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤. HTMLê³¼ ìœ ì‚¬í•œ ë¬¸ë²•ìœ¼ë¡œ ì‘ì„±í•  ìˆ˜ ìˆì–´ ì§ê´€ì ì´ê³  ê°€ë…ì„±ì´ ë†’ìŠµë‹ˆë‹¤.

    **Reactì—ì„œ ì‚¬ìš©í•˜ëŠ” ì´ìœ **
    
    - **ê°€ë…ì„± í–¥ìƒ**: UI êµ¬ì¡°ë¥¼ í•œëˆˆì— ì´í•´ ê°€ëŠ¥.
    - **ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜ ê°œë°œ**: HTML-like ì½”ë“œë¥¼ JavaScriptì—ì„œ ì§ì ‘ ì‘ì„± ê°€ëŠ¥.
    - **Virtual DOMê³¼ì˜ í†µí•©**: JSXëŠ” ë‚´ë¶€ì ìœ¼ë¡œ Reactì˜ createElement í•¨ìˆ˜ë¡œ ë³€í™˜ë˜ì–´ Virtual DOM ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

  - JSXëŠ” ì–´ë–»ê²Œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¡œ ë³€í™˜ë˜ë‚˜ìš”?

    JSXëŠ” Babelê³¼ ê°™ì€ íŠ¸ëœìŠ¤íŒŒì¼ëŸ¬ë¥¼ í†µí•´ **Reactì˜** createElement **í•¨ìˆ˜ í˜¸ì¶œ**ë¡œ ë³€í™˜ë©ë‹ˆë‹¤.

- í”„ë¡œì íŠ¸ì—ì„œ Babelì„ ì–´ë–»ê²Œ ì„¤ì •í•˜ì—¬ JSXë¥¼ íŠ¸ëœìŠ¤íŒŒì¼ë§í–ˆë‚˜ìš”? Babelì´ë€ ê²ƒì€ ë¬´ì—‡ì¸ê°€ìš”?

  - Babelì´ë€?
    - Babelì€ **JavaScript íŠ¸ëœìŠ¤íŒŒì¼ëŸ¬**ë¡œ, ìµœì‹  JavaScript ì½”ë“œë¥¼ ì˜¤ë˜ëœ ë¸Œë¼ìš°ì €ì—ì„œë„ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ íŠ¸ëœìŠ¤íŒŒì¼ë§í•©ë‹ˆë‹¤.
  - ì„¤ì •í•˜ì‹  ì˜µì…˜ë“¤ì˜ ì—­í• ì€ ë¬´ì—‡ì¸ê°€ìš”?
    - jsx ë¬¸ë²•ì„ js ì½”ë“œë¡œ ë³€í™˜í•˜ëŠ” ì—­í• 

- `createElement` í•¨ìˆ˜ëŠ” ì–´ë–»ê²Œ êµ¬í˜„í•˜ì…¨ë‚˜ìš”?

  ```jsx
  function createElement(type, props, ...children) {
    return {
      type,
      props: {
        ...props,
        children: children.map(child =>
          typeof child === "object" ? child : { type: "TEXT_ELEMENT", props: { nodeValue: child, children: [] } }
        )
      }
    };
  }
  ```

- Virtual DOMì´ë€ ë¬´ì—‡ì´ë©°, ì‹¤ì œ DOMê³¼ì˜ ì°¨ì´ì ì€ ë¬´ì—‡ì¸ê°€ìš”?

  - Virtual DOMì€ **ë©”ëª¨ë¦¬ ë‚´ì—ì„œ ê°€ìƒìœ¼ë¡œ ìƒì„±ë˜ëŠ” DOM ê°ì²´ íŠ¸ë¦¬**ì…ë‹ˆë‹¤. UI ìƒíƒœë¥¼ ì¶”ì í•˜ê³  ì—…ë°ì´íŠ¸ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.
  - **Virtual DOM**: ë©”ëª¨ë¦¬ì—ì„œ ë™ì‘í•˜ë©°, ì—…ë°ì´íŠ¸ ì‹œ ë¹ ë¥¸ ë¹„êµ(diffing) í›„ ì‹¤ì œ DOMì— ìµœì†Œí•œì˜ ë³€ê²½ì„ ì ìš©. â†’ React Batching, useStateì˜ setStateë¥¼ ì´ìš©í•´ì„œ ìƒíƒœë¥¼ ë³€ê²½í•  ë•Œ í•œë²ˆì— ëª¨ì•„ì„œ ì—…ë°ì´íŠ¸ í•˜ëŠ” ê²ƒ
  - **ì‹¤ì œ DOM**: ë¸Œë¼ìš°ì €ê°€ ë Œë”ë§í•˜ëŠ” ì‹¤ì œ UI êµ¬ì¡°. DOM ì—…ë°ì´íŠ¸ëŠ” ìƒëŒ€ì ìœ¼ë¡œ ëŠë¦¼.
  - ë¸Œë¼ìš°ì € ë Œë”ë§
    - ë ˆì´ì•„ì›ƒ â†’ í˜ì¸íŒ…
    - **reflow** â†’ **repaint**

- JSX ì½”ë“œê°€ ì–´ë–»ê²Œ Virtual DOM ê°ì²´ë¡œ ë³€í™˜ë˜ëŠ”ì§€ ì„¤ëª…í•´ ì£¼ì„¸ìš”.

- Virtual DOMê³¼ ì‹¤ì œ DOMì˜ ì°¨ì´ì ì„ ì„¤ëª…í•´ ì£¼ì„¸ìš”. í”„ë ˆì„ì›Œí¬ì—ì„œ Virtual DOMì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”?

  - **ì„±ëŠ¥ ìµœì í™”**: ì „ì²´ DOM ì—…ë°ì´íŠ¸ ëŒ€ì‹  í•„ìš”í•œ ë¶€ë¶„ë§Œ ë³€ê²½.
  - **ì¶”ìƒí™”**: ê°œë°œìëŠ” DOM ì¡°ì‘ ëŒ€ì‹  Reactì˜ ì„ ì–¸ì  UIë¥¼ ì‘ì„±.

# Week2: ì†”ë£¨ì…˜ ë° í•´ì„¤

ì•„ë˜ ì½”ë“œëŠ” ì°¸ê³ ë§Œ í•´ì£¼ì„¸ìš”

------

### Day 1-2: Virtual DOMì„ ì‹¤ì œ DOMìœ¼ë¡œ ë Œë”ë§í•˜ê¸°

### ğŸ’» ì†”ë£¨ì…˜ ë° í•´ì„¤

**1. `render` í•¨ìˆ˜ êµ¬í˜„**

```jsx
// src/render.js
function render(vdom, container) {
  // VDOMì´ ë¬¸ìì—´ì´ë‚˜ ìˆ«ìì¸ ê²½ìš° í…ìŠ¤íŠ¸ ë…¸ë“œë¥¼ ìƒì„±
  if (typeof vdom === 'string' || typeof vdom === 'number') {
    const textNode = document.createTextNode(vdom);
    container.appendChild(textNode);
    return;
  }

  // VDOMì˜ typeì´ í•¨ìˆ˜ì¸ ê²½ìš° ì»´í¬ë„ŒíŠ¸ë¡œ ê°„ì£¼í•˜ê³  ì¬ê·€ì ìœ¼ë¡œ ì²˜ë¦¬
  if (typeof vdom.type === 'function') {
    const componentVdom = vdom.type(vdom.props);
    render(componentVdom, container);
    return;
  }
  
  const domElement = document.createElement(vdom.type);

  if (vdom.props) {
    Object.keys(vdom.props)
      .filter((key) => key !== 'children')
      .forEach((name) => {
        domElement[name] = vdom.props[name];
      });
  }

  if (vdom.props.children) {
    const children = Array.isArray(vdom.props.children)
      ? vdom.props.children
      : [vdom.props.children];

    children.forEach((child) => render(child, domElement));
  }

  container.appendChild(domElement);
}

export default render;
```

**2. `main.js`ì—ì„œ `render` í•¨ìˆ˜ ì‚¬ìš©**

```jsx
// src/main.js
import App from './App.jsx';
import render from './render.js';

const root = document.getElementById('root');
const appElement = App();

render(appElement, root);
```

------

### ğŸ’¡ í•´ì„¤

- `render` í•¨ìˆ˜ëŠ” Virtual DOM ê°ì²´ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ ì‹¤ì œ DOM ë…¸ë“œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
- ì¬ê·€ì ìœ¼ë¡œ VDOM íŠ¸ë¦¬ë¥¼ ìˆœíšŒí•˜ë©° ê° ë…¸ë“œì— ëŒ€í•´ DOM ë…¸ë“œë¥¼ ìƒì„±í•˜ê³ , ë¶€ëª¨ ë…¸ë“œì— ì¶”ê°€í•©ë‹ˆë‹¤.
- **í…ìŠ¤íŠ¸ ë…¸ë“œ**, **í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸**, **ì¼ë°˜ ìš”ì†Œ**ë¥¼ êµ¬ë¶„í•˜ì—¬ ì²˜ë¦¬í•©ë‹ˆë‹¤.

------

### Day 3-4: ìƒíƒœ ê´€ë¦¬ì™€ `useState` êµ¬í˜„

### ğŸ’» ì†”ë£¨ì…˜ ë° í•´ì„¤

**1. `useState` í•¨ìˆ˜ êµ¬í˜„**

```jsx
const values = {
  stateIndex: 0,
  states: []
};

function useState<T>(initialState?: T) {
    const index = values.stateIndex

    if (typeof values.states[index] === 'undefined') {
      values.states[index] = initialState
    }
    const state = values.states[index] as T

    function setState(newState: T) {
      if (shallowEqual(state, newState)) {
        return
      }

      values.states[index] = newState
      queueMicrotask(() => {
        rerender()
      })
    }

    values.stateIndex += 1

    return [state, setState] as [T, (newState: T) => void]
  }
  
  function shallowEqual(value1, value2) {
    return Object.is(value1, value2);
  }
```

**2. `rerender` í•¨ìˆ˜ êµ¬í˜„**

```jsx
// src/main.js
import App from './App.jsx';
import render from './render.js';

const root = document.getElementById('root');

function rerender() {
  root.innerHTML = '';
  const appElement = App();
  render(appElement, root);
}

rerender();
```

**3. ì¹´ìš´í„° ì»´í¬ë„ŒíŠ¸ ì‘ì„±**

```jsx
// src/Counter.jsx
import useState from './useState.js';

function Counter() {
  const [count, setCount] = useState(0);

  return (
    <div>
      <p>í˜„ì¬ ì¹´ìš´íŠ¸: {count}</p>
      <button onclick={() => setCount(count + 1)}>ì¦ê°€</button>
    </div>
  );
}

export default Counter;
```

**4. `App` ì»´í¬ë„ŒíŠ¸ì—ì„œ `Counter` ì‚¬ìš©**

```jsx
// src/App.jsx
import Counter from './Counter.jsx';

function App() {
  return (
    <div id="app">
      <h1>My React Clone</h1>
      <Counter />
    </div>
  );
}

export default App;
```

------

### ğŸ’¡ í•´ì„¤

- `useState` í•¨ìˆ˜ëŠ” ìƒíƒœ ê°’ì„ ë³´ì¡´í•˜ê³  ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.
- ìƒíƒœê°€ ë³€ê²½ë˜ë©´ `setState` í•¨ìˆ˜ë¥¼ í†µí•´ `rerender`ë¥¼ í˜¸ì¶œí•˜ì—¬ UIë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
- `rerender` í•¨ìˆ˜ëŠ” ê¸°ì¡´ DOMì„ ì´ˆê¸°í™”í•˜ê³ , ìƒˆë¡œìš´ Virtual DOMì„ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ì‹œ ë Œë”ë§í•©ë‹ˆë‹¤.
- ê°„ë‹¨í•œ ì¹´ìš´í„° ì˜ˆì œë¥¼ í†µí•´ ìƒíƒœ ê´€ë¦¬ì™€ UI ì—…ë°ì´íŠ¸ ê³¼ì •ì„ ê²½í—˜í–ˆìŠµë‹ˆë‹¤.

------

### Day 5: ê°„ë‹¨í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‘ì„± ë° ì‹¤ìŠµ

### ğŸ’» ì†”ë£¨ì…˜ ë° í•´ì„¤

**1. TODO ë¦¬ìŠ¤íŠ¸ ì•± ì‘ì„±**

```jsx
// src/TodoApp.jsx
import useState from './useState.js';

function TodoApp() {
  const [todos, setTodos] = useState([]);
  const [input, setInput] = useState('');

  function addTodo() {
    setTodos([...todos, input]);
    setInput('');
  }

  return (
    <div>
      <h2>í•  ì¼ ëª©ë¡</h2>
      <input
        type="text"
        value={input}
        oninput={(e) => setInput(e.target.value)}
      />
      <button onclick={addTodo}>ì¶”ê°€</button>
      <ul>
        {todos.map((todo) => (
          <li>{todo}</li>
        ))}
      </ul>
    </div>
  );
}

export default TodoApp;
```

**2. `App` ì»´í¬ë„ŒíŠ¸ì—ì„œ `TodoApp` ì‚¬ìš©**

```jsx
// src/App.jsx
import TodoApp from './TodoApp.jsx';

function App() {
  return (
    <div id="app">
      <h1>My React Clone</h1>
      <TodoApp />
    </div>
  );
}

export default App;
```

------

### ğŸ’¡ í•´ì„¤

- `useState`ë¥¼ í™œìš©í•˜ì—¬ ë³µìˆ˜ì˜ ìƒíƒœ(`todos`, `input`)ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.
- ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬(`onclick`, `oninput`)ë¥¼ í†µí•´ ì‚¬ìš©ì ì…ë ¥ì„ ì²˜ë¦¬í•˜ê³  ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
- ìƒíƒœ ë³€ê²½ ì‹œ `rerender`ë¥¼ í†µí•´ UIê°€ ì—…ë°ì´íŠ¸ë˜ì–´ ìµœì‹  ìƒíƒœë¥¼ ë°˜ì˜í•©ë‹ˆë‹¤.
- `map` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¦¬ìŠ¤íŠ¸ë¥¼ ë™ì ìœ¼ë¡œ ë Œë”ë§í•©ë‹ˆë‹¤.

### 2ì£¼ì°¨ ë©´ì ‘ì§ˆë¬¸

- Reactì—ì„œ rendering í•¨ìˆ˜ì˜ ë™ì‘ì€ ì–´ë–¤ì‹ìœ¼ë¡œ ì´ë£¨ì–´ì§€ë‚˜ìš”?
	- JSXëŠ” ë°”ë²¨ì„ í†µí•´ `createElement` í•¨ìˆ˜ë¡œ ë³€í™˜ë˜ê³ , ì´ í•¨ìˆ˜ëŠ” Virtual DOM ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì´í›„ ì´ Virtual DOMì„ ì‹¤ì œ DOMìœ¼ë¡œ ë Œë”ë§í•˜ëŠ” ê³¼ì •ì´ ì§„í–‰ëœë‹¤.
	- `render` í•¨ìˆ˜ëŠ” Virtual DOMì„ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ ì‹¤ì œ DOM ë…¸ë“œë¥¼ ìƒì„±í•˜ê³ , ë¶€ëª¨ ë…¸ë“œì— ì¶”ê°€í•˜ëŠ” ì—­í• ì„ í•œë‹¤.
- ìƒíƒœë€ ë¬´ì—‡ì´ë©°, ìƒíƒœ ê´€ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?
	- ìƒíƒœë€ ì»´í¬ë„ŒíŠ¸ê°€ ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ìœ ì§€í•˜ê³  ê´€ë¦¬í•˜ëŠ” ë°ì´í„°ì´ë‹¤. ì‚¬ìš©ìì˜ ì…ë ¥, ì„œë²„ë¡œë¶€í„° ë°›ì€ ë°ì´í„°, UIì˜ í˜„ì¬ ìƒíƒœ(ì˜ˆ : ëª¨ë‹¬ì°½ì´ ì—´ë ¸ëŠ”ì§€ ì—¬ë¶€) ë“±ì´ ëª¨ë‘ ìƒíƒœê°€ ë  ìˆ˜ ìˆë‹¤. Reactì—ì„œ ìƒíƒœê°€ ë³€ê²½ë˜ë©´ ì»´í¬ë„ŒíŠ¸ëŠ” ë¦¬ë Œë”ë§ë˜ì–´ ë³€ê²½ëœ ë‚´ìš©ì„ í™”ë©´ì— ë°˜ì˜í•œë‹¤.
- useStateëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–¤ ì‹ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìˆì„ê¹Œìš”?
- ìƒíƒœë¥¼ ì „ì—­ì ìœ¼ë¡œ ê´€ë¦¬í•´ì•¼ í•˜ëŠ” ê²½ìš°ì™€ ì§€ì—­ì ìœ¼ë¡œ ê´€ë¦¬í•´ì•¼ í•˜ëŠ” ê²½ìš°ëŠ” ê°ê° ì–´ë–¤ ì‚¬ë¡€ê°€ ìˆë‚˜ìš”?

# Week3: ì†”ë£¨ì…˜ ë° í•´ì„¤

ì´ì œ ì—¬ëŸ¬ë¶„ì´ ìˆ˜í–‰í•œ ê³¼ì œì— ëŒ€í•œ í•´ì„¤ê³¼ ì˜ˆì‹œ ì½”ë“œë¥¼ ì œê³µí•˜ê² ìŠµë‹ˆë‹¤. ì•„ë˜ëŠ” ì‹¤ì œë¡œ ë™ì‘í•˜ëŠ” ì½”ë“œì´ë©°, ì´ë¥¼ í†µí•´ êµ¬í˜„ ë°©ë²•ì„ ìì„¸íˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

------

### Day 1-2: Virtual DOM ë¹„êµ(diffing) ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„

### ğŸ’» ì†”ë£¨ì…˜ ë° í•´ì„¤

**1. `updateDOM` í•¨ìˆ˜ êµ¬í˜„**

```tsx
/* src/updateDOM.ts */
import { checkIsSameVDOM } from './utils/checkIsSameVDOM';
import createDOM from './createDOM';
import { VirtualDOM } from './types';
import { checkIsTextNode } from './utils/checkIsTextNode';

export default function updateDOM(
  $parent: ChildNode,
  oldVDOM?: VirtualDOM | null,
  newVDOM?: VirtualDOM | null,
  idx = 0,
) {
  if (newVDOM == undefined) {
    if (oldVDOM != undefined) {
      $parent.removeChild($parent.childNodes[idx]);
      return true;
    }
    return false;
  }

  if (oldVDOM == undefined) {
    $parent.appendChild(createDOM(newVDOM));
    return false;
  }

  if (!checkIsSameVDOM(oldVDOM, newVDOM)) {
    $parent.replaceChild(createDOM(newVDOM), $parent.childNodes[idx]);
    return false;
  }
  

  const { node: newNode } = newVDOM;
  const { node: oldNode } = oldVDOM;

  if (!checkIsTextNode(newNode) && !checkIsTextNode(oldNode)) {
    updateAttributes(
      $parent.childNodes[idx] as Element,
      newNode.props ?? {},
      oldNode.props ?? {},
    );

    const length = Math.max(
      newNode.children?.length ?? 0,
      oldNode.children?.length ?? 0,
    );
    let nodeDeleteCnt = 0;
    
    for (let i = 0; i < length; i++) {
      const isNodeDeleted = updateDOM(
        $parent?.childNodes[idx],
        oldNode.children?.[i],
        newNode.children?.[i],
        i - nodeDeleteCnt,
      );
      
      if (isNodeDeleted) {
        nodeDeleteCnt += 1;
      }
    }
  }

  return false;
}

function updateAttributes(
  target: Element,
  newProps: Record<string, unknown>,
  oldProps: Record<string, unknown>,
) {
  for (const [attr, value] of Object.entries(newProps)) {
    if (oldProps[attr] === newProps[attr]) {
      continue;
    }
    
    (target as any)[attr] = value;
  }

  for (const attr of Object.keys(oldProps)) {
    if (newProps[attr] !== undefined) {
      continue;
    }
    
    if (attr.startsWith('on')) {
      (target as any)[attr] = null;
      // addEventListenerë¥¼ ì´ìš©í•´ì„œ ì´ë²¤íŠ¸ ë“±ë¡ì„ í•œ ê²½ìš°ì—ëŠ” ì•„ë˜ì™€ ê°™ì´ ì²˜ë¦¬
      // removeEventListener
    // className ì œê±°
    } else if (attr.startsWith('class')) {
      target.removeAttribute('class');
    } else {
      target.removeAttribute(attr);
    }
  }
}
```

`updateDOM` í•¨ìˆ˜ëŠ” ì´ì „ì˜ Virtual DOMê³¼ ìƒˆë¡œìš´ Virtual DOMì„ ë¹„êµí•˜ì—¬ ì‹¤ì œ DOMì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.

**í•´ì„¤:**

- ë…¸ë“œ ë¹„êµ ë° ì—…ë°ì´íŠ¸:


    oldVDOM ê³¼ newVDOM
    ì„ ë¹„êµí•˜ì—¬ ì„¸ ê°€ì§€ ê²½ìš°ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤:
    1. `newVDOM`ì´ `undefined`ì¸ ê²½ìš°: í•´ë‹¹ ë…¸ë“œë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.
    2. `oldVDOM`ì´ `undefined`ì¸ ê²½ìš°: ìƒˆë¡œìš´ ë…¸ë“œë¥¼ ìƒì„±í•˜ì—¬ ì¶”ê°€í•©ë‹ˆë‹¤.
    3. ë‘ ë…¸ë“œê°€ ë™ì¼í•˜ì§€ ì•Šì€ ê²½ìš°: ìƒˆë¡œìš´ ë…¸ë“œë¡œ êµì²´í•©ë‹ˆë‹¤.

- ì†ì„± ì—…ë°ì´íŠ¸:

  - `updateAttributes` í•¨ìˆ˜ë¥¼ í†µí•´ ìƒˆë¡œìš´ ì†ì„±ê³¼ ì´ì „ ì†ì„±ì„ ë¹„êµí•˜ì—¬ ë³€ê²½ëœ ë¶€ë¶„ë§Œ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
  - ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬, í´ë˜ìŠ¤, ì¼ë°˜ ì†ì„±ì„ ì ì ˆíˆ ì²˜ë¦¬í•©ë‹ˆë‹¤.

- ì¬ê·€ì  ì—…ë°ì´íŠ¸:

  - ìì‹ ë…¸ë“œë“¤ë„ ì¬ê·€ì ìœ¼ë¡œ `updateDOM` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ íŠ¸ë¦¬ ì „ì²´ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
  - `nodeDeleteCnt`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë…¸ë“œ ì‚­ì œ ì‹œ ì¸ë±ìŠ¤ë¥¼ ì¡°ì •í•©ë‹ˆë‹¤.

**2. `createDOM` í•¨ìˆ˜ êµ¬í˜„**

```tsx
/* src/createDOM.ts */
import _ from 'lodash';
import { checkIsTextNode } from './utils/checkIsTextNode';
import { VirtualDOM } from './types';

const createDOM = (VDOM: VirtualDOM): HTMLElement | Text => {
  const { node } = VDOM;

  if (checkIsTextNode(node)) {
    if (Array.isArray(node)) {
      return document.createTextNode(node.toString());
    }
    if (typeof node === 'object' && node !== null) {
      return document.createTextNode(JSON.stringify(node));
    }
    return document.createTextNode(node ? node.toString() : '');
  }

  const element = document.createElement(node.tag);

  if (node.props) {
    for (const key in node.props) {
      if (key.startsWith('data-')) {
        const dataKey = _.camelCase(key.slice(5));
        element.dataset[dataKey] = node.props[key] as string;
        continue;
      }

      if (key.startsWith('on') || key === 'className' || key === 'checked') {
        (element as any)[key] = node.props[key];
        continue;
      }

      element.setAttribute(key, node.props[key] as string);
    }
  }

  node.children?.forEach((child) => {
    if (child) {
      element.append(createDOM(child));
    }
  });

  return element;
};

export default createDOM;
```

**í•´ì„¤:**

- ë…¸ë“œ ìƒì„±:
  - í…ìŠ¤íŠ¸ ë…¸ë“œì¸ ê²½ìš° `document.createTextNode`ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±í•©ë‹ˆë‹¤.
  - ì¼ë°˜ ìš”ì†Œì¸ ê²½ìš° `document.createElement`ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±í•©ë‹ˆë‹¤.
- ì†ì„± ì„¤ì •:
  - `data-`ë¡œ ì‹œì‘í•˜ëŠ” ì†ì„±ì€ `dataset`ì„ í†µí•´ ì„¤ì •í•©ë‹ˆë‹¤.
  - ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬, `className`, `checked` ë“±ì˜ ì†ì„±ì€ ì§ì ‘ ìš”ì†Œì— ì„¤ì •í•©ë‹ˆë‹¤.
  - ê·¸ ì™¸ì˜ ì†ì„±ì€ `setAttribute`ë¥¼ í†µí•´ ì„¤ì •í•©ë‹ˆë‹¤.
- ìì‹ ë…¸ë“œ ì²˜ë¦¬:
  - ìì‹ ë…¸ë“œê°€ ìˆëŠ” ê²½ìš° ì¬ê·€ì ìœ¼ë¡œ `createDOM`ì„ í˜¸ì¶œí•˜ì—¬ ìš”ì†Œì— ì¶”ê°€í•©ë‹ˆë‹¤.

------

### Day 3-4: ì´ë²¤íŠ¸ ì²˜ë¦¬ ë° Synthetic Event ì‹œìŠ¤í…œ êµ¬í˜„

### ğŸ’» ì†”ë£¨ì…˜ ë° í•´ì„¤

**1. ì´ë²¤íŠ¸ ì²˜ë¦¬ êµ¬í˜„**

ìœ„ì˜ `createDOM` í•¨ìˆ˜ì—ì„œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì„¤ì •í•˜ëŠ” ë¶€ë¶„ì„ ì‚´í´ë³´ë©´:

```tsx
if (key.startsWith('on') || key === 'className' || key === 'checked') {
  (element as any)[key] = node.props[key];
  continue;
}
```

- ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ëŠ” `on`ìœ¼ë¡œ ì‹œì‘í•˜ë¯€ë¡œ, í•´ë‹¹ ì†ì„±ì„ ìš”ì†Œì— ì§ì ‘ ì„¤ì •í•©ë‹ˆë‹¤.
- ì˜ˆë¥¼ ë“¤ì–´, `onclick` ì†ì„±ì„ ì„¤ì •í•˜ì—¬ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.

**2. ì´ë²¤íŠ¸ ìœ„ì„ ë° Synthetic Event ì‹œìŠ¤í…œ**

ì´ êµ¬í˜„ì—ì„œëŠ” ì´ë²¤íŠ¸ ìœ„ì„ì´ë‚˜ Synthetic Event ì‹œìŠ¤í…œì„ ë³„ë„ë¡œ êµ¬í˜„í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ëŒ€ì‹  ê° ìš”ì†Œì— ì§ì ‘ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì„¤ì •í•˜ì—¬ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.

**í•´ì„¤:**

- ì§ì ‘ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì„¤ì •:

  - ê° ìš”ì†Œì— í•„ìš”í•œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì§ì ‘ ì„¤ì •í•˜ì—¬ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.
  - ê°„ë‹¨í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ì´ ë°©ë²•ì´ ì¶©ë¶„í•  ìˆ˜ ìˆì§€ë§Œ, ê·œëª¨ê°€ ì»¤ì§ˆ ê²½ìš° ì´ë²¤íŠ¸ ìœ„ì„ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ì´ë²¤íŠ¸ ìœ„ì„ ë° Synthetic Event:

  - ì´ë²¤íŠ¸ ìœ„ì„ì€ ìƒìœ„ ìš”ì†Œì—ì„œ í•˜ìœ„ ìš”ì†Œì˜ ì´ë²¤íŠ¸ë¥¼ í•œ ë²ˆì— ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ, ë©”ëª¨ë¦¬ íš¨ìœ¨ê³¼ ì„±ëŠ¥ í–¥ìƒì— ë„ì›€ì´ ë©ë‹ˆë‹¤.

  - Synthetic Event ì‹œìŠ¤í…œì€ ë¸Œë¼ìš°ì € ê°„ì˜ ì´ë²¤íŠ¸ ì°¨ì´ë¥¼ ì¶”ìƒí™”í•˜ì—¬ ì¼ê´€ëœ ì´ë²¤íŠ¸ ì²˜ë¦¬ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.

  - í˜„ì¬ êµ¬í˜„ì—ì„œëŠ” ì´ëŸ¬í•œ ë¶€ë¶„ì´ ìƒëµë˜ì–´ ìˆìœ¼ë¯€ë¡œ, í•„ìš”ì— ë”°ë¼ ì¶”ê°€ êµ¬í˜„ì´ í•„ìš”í•©ë‹ˆë‹¤.

    ```jsx
    class SyntheticEventSystem {
      constructor(root) {
        this.root = root; // ì´ë²¤íŠ¸ ìœ„ì„ ëŒ€ìƒ
        this.eventHandlers = {}; // ì´ë²¤íŠ¸ íƒ€ì…ë³„ í•¸ë“¤ëŸ¬ ì €ì¥
    
        this.root.addEventListener('click', this.handleEvent.bind(this), false);
        this.root.addEventListener('input', this.handleEvent.bind(this), false);
      }
    
      // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡
      addEventListener(eventType, element, callback) {
        if (!this.eventHandlers[eventType]) {
          this.eventHandlers[eventType] = [];
        }
        this.eventHandlers[eventType].push({ element, callback });
      }
    
      // ì´ë²¤íŠ¸ ìœ„ì„ ì²˜ë¦¬
      handleEvent(nativeEvent) {
        const { type, target } = nativeEvent;
    
        if (this.eventHandlers[type]) {
          this.eventHandlers[type].forEach(({ element, callback }) => {
            if (element.contains(target)) {
              const syntheticEvent = this.createSyntheticEvent(nativeEvent);
              callback(syntheticEvent);
            }
          });
        }
      }
    
      // Synthetic Event ê°ì²´ ìƒì„±
      createSyntheticEvent(nativeEvent) {
        return {
          nativeEvent,
          type: nativeEvent.type,
          target: nativeEvent.target,
          currentTarget: nativeEvent.currentTarget,
          preventDefault: () => nativeEvent.preventDefault(),
          stopPropagation: () => nativeEvent.stopPropagation(),
        };
      }
    }
    ```

------

### Day 5: `useEffect` í›… êµ¬í˜„ ë° ì»´í¬ë„ŒíŠ¸ ìƒëª…ì£¼ê¸° ê´€ë¦¬

```tsx
/* src/valueToUI.ts */
import { Component } from '@/libs/jsx/jsx-runtime';
import { PageProps } from './types';
import updateDOM from './updateDOM';
import shallowEqual from './utils/shallowEquals';

interface ValueObject {
  states: any[];
  stateIndex: number;
  
  effectList: (() => void)[];
  dependencies: (any[] | undefined)[];
  depsIndex: number;
}

interface RenderObject {
  root?: Component<PageProps>;
  $parent?: HTMLElement;
  pageParams?: string[];
  currentVDOM?: JSX.Element;
  futureVDOM?: JSX.Element;
}

function valueToUI() {
  const values: ValueObject = {
    states: [],
    stateIndex: 0,
    effectList: [],
    dependencies: [],
    depsIndex: 0,
  };

  const renderInfo: RenderObject = {};

  function _render() {
    values.stateIndex = 0;
    values.depsIndex = 0;
    values.effectList = [];
    
    renderInfo.futureVDOM = renderInfo.root?.({
      pageParams: renderInfo.pageParams,
    });

    updateDOM(
      renderInfo.$parent as ChildNode,
      renderInfo.currentVDOM,
      renderInfo.futureVDOM,
    );

    renderInfo.currentVDOM = renderInfo.futureVDOM;
    // ë Œë” ì´í›„ì— useEffect ì½œë°± ì‹¤í–‰
    values.effectList.forEach((effect) => effect());
  }

  function render(
    rootElement: HTMLElement,
    component: Component<PageProps>,
    { pageParams }: { pageParams: string[] },
  ) {
    if (renderInfo.$parent === rootElement && renderInfo.root === component) {
      renderInfo.pageParams = pageParams;
      _render();
      return;
    }
    renderInfo.$parent = rootElement;
    renderInfo.root = component;
    renderInfo.pageParams = pageParams;
    values.states = [];
    values.dependencies = [];
    _render();
  }

  function useState<T>(initialState?: T) {
    const index = values.stateIndex;

    if (typeof values.states[index] === 'undefined') {
      values.states[index] = initialState;
    }
    const state = values.states[index] as T;

    function setState(newState: T) {
      if (shallowEqual(state, newState)) {
        return;
      }

      values.states[index] = newState;
      queueMicrotask(() => {
        _render();
      });
    }

    values.stateIndex += 1;

    return [state, setState] as [T, (newState: T) => void];
  }

  function useEffect(callback: () => void, dependencies?: any[]) {
    const index = values.depsIndex;
    values.effectList.push(() => {
      const oldDependencies = values.dependencies[index];
      let hasChanged = true;
      if (oldDependencies) {
        hasChanged =
          dependencies?.some((val, idx) => {
            return !shallowEqual(val, oldDependencies[idx]);
          }) ?? true;
      }
      
      if (hasChanged) {
        values.dependencies[index] = dependencies;
        callback();
      }
    });
    values.depsIndex += 1;
  }

  return { render, useState, useEffect };
}

export const { render, useState, useEffect } = valueToUI();
```

### ğŸ’» ì†”ë£¨ì…˜ ë° í•´ì„¤

**1. `useEffect` í›… ë° ìƒíƒœ ê´€ë¦¬ êµ¬í˜„**

**í•´ì„¤:**

- ìƒíƒœ ê´€ë¦¬ (`useState`):
  - `values.states` ë°°ì—´ì„ ì‚¬ìš©í•˜ì—¬ ê° ìƒíƒœë¥¼ ì €ì¥í•©ë‹ˆë‹¤.
  - `stateIndex`ë¥¼ í†µí•´ ìƒíƒœì˜ ìœ„ì¹˜ë¥¼ ì¶”ì í•©ë‹ˆë‹¤.
  - `setState` í•¨ìˆ˜ëŠ” ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ê³ , ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆì„ ê²½ìš° `_render` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ì»´í¬ë„ŒíŠ¸ë¥¼ ë‹¤ì‹œ ë Œë”ë§í•©ë‹ˆë‹¤.
- ì´í™íŠ¸ ê´€ë¦¬ (`useEffect`):
  - `values.effectList` ë°°ì—´ì— ì´í™íŠ¸ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.
  - `dependencies`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ì¡´ì„± ë°°ì—´ì„ ê´€ë¦¬í•˜ê³ , ê°’ì´ ë³€ê²½ë˜ì—ˆì„ ë•Œë§Œ ì´í™íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
  - `depsIndex`ë¥¼ í†µí•´ ì´í™íŠ¸ì˜ ìœ„ì¹˜ë¥¼ ì¶”ì í•©ë‹ˆë‹¤.
- ë Œë”ë§ (`render`):
  - `_render` í•¨ìˆ˜ëŠ” í˜„ì¬ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•˜ê³ , Virtual DOMì„ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
  - `updateDOM` í•¨ìˆ˜ë¥¼ í†µí•´ ì‹¤ì œ DOMì— ë³€ê²½ ì‚¬í•­ì„ ë°˜ì˜í•©ë‹ˆë‹¤.
  - ì´í™íŠ¸ ë¦¬ìŠ¤íŠ¸ë¥¼ ìˆœíšŒí•˜ì—¬ í•„ìš”í•œ ì´í™íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

**2. ì˜ˆì œ ì»´í¬ë„ŒíŠ¸ì—ì„œ `useState`ì™€ `useEffect` ì‚¬ìš©**

```tsx
/* src/Counter.tsx */
import { useState, useEffect } from './valueToUI';

function Counter() {
  const [count, setCount] = useState(0);

  useEffect(() => {
    console.log(`í˜„ì¬ ì¹´ìš´íŠ¸: ${count}`);
  }, [count]);

  return (
    <div>
      <p>ì¹´ìš´íŠ¸: {count}</p>
      <button onclick={() => setCount(count + 1)}>ì¦ê°€</button>
    </div>
  );
}

export default Counter;
```

**í•´ì„¤:**

- ìƒíƒœ ì‚¬ìš©:
  - `useState`ë¥¼ ì‚¬ìš©í•˜ì—¬ `count` ìƒíƒœë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.
  - `setCount` í•¨ìˆ˜ë¥¼ í†µí•´ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ê³ , ìƒíƒœ ë³€ê²½ ì‹œ ì»´í¬ë„ŒíŠ¸ë¥¼ ë‹¤ì‹œ ë Œë”ë§í•©ë‹ˆë‹¤.
- ì´í™íŠ¸ ì‚¬ìš©:
  - `useEffect`ë¥¼ ì‚¬ìš©í•˜ì—¬ `count` ê°’ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì½˜ì†”ì— ë¡œê·¸ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.
  - ì˜ì¡´ì„± ë°°ì—´ `[count]`ë¥¼ í†µí•´ `count`ê°€ ë³€ê²½ë  ë•Œë§Œ ì´í™íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
- ì´ë²¤íŠ¸ ì²˜ë¦¬:
  - `button` ìš”ì†Œì˜ `onclick` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ í†µí•´ `setCount` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.

------

## ğŸ“ ê³¼ì œ ì†”ë£¨ì…˜

**1. `updateDOM` í•¨ìˆ˜ êµ¬í˜„í•˜ê¸°**

- ìœ„ì—ì„œ ì œê³µëœ `updateDOM` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ì „ê³¼ ìƒˆë¡œìš´ Virtual DOMì„ ë¹„êµí•˜ê³  ë³€ê²½ëœ ë¶€ë¶„ë§Œ ì‹¤ì œ DOMì— ë°˜ì˜í•©ë‹ˆë‹¤.

**2. ì´ë²¤íŠ¸ ì²˜ë¦¬ ì‹œìŠ¤í…œ êµ¬í˜„í•˜ê¸°**

- `createDOM` í•¨ìˆ˜ì—ì„œ ìš”ì†Œì— ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì§ì ‘ ì„¤ì •í•˜ì—¬ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.
- ì´ë²¤íŠ¸ ìœ„ì„ì´ë‚˜ Synthetic Event ì‹œìŠ¤í…œì€ êµ¬í˜„í•˜ì§€ ì•Šì•˜ì§€ë§Œ, í•„ìš”ì— ë”°ë¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**3. `useEffect` í›… êµ¬í˜„í•˜ê¸°**

- `valueToUI` í•¨ìˆ˜ ë‚´ì—ì„œ `useEffect` í›…ì„ êµ¬í˜„í•˜ê³ , ì˜ì¡´ì„± ë°°ì—´ì„ ê´€ë¦¬í•˜ì—¬ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì´í™íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

**4. ì‹¤ìŠµ í”„ë¡œì íŠ¸ ì™„ì„±í•˜ê¸°**

- ì´ì „ì— ë§Œë“  ì»´í¬ë„ŒíŠ¸ì— `useState`, `useEffect` ë“±ì„ ì ìš©í•˜ì—¬ ê¸°ëŠ¥ì„ ê°œì„ í•˜ê³ , ì‹¤ì œë¡œ ë™ì‘í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì™„ì„±í•©ë‹ˆë‹¤.





